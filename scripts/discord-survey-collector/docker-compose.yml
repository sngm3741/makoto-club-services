version: "3.9"

services:
  discord-bot:
    build: .
    env_file:
      - .env
    volumes:
      - ./data:/app/data
    restart: "no"

  mongo-import:
    build: .
    env_file:
      - .env
    environment:
      MONGO_URI: ${MONGO_URI}
      MONGO_DB: ${MONGO_DB:-makoto-club}
      MONGO_IMPORT_DROP: ${MONGO_IMPORT_DROP:-true}
      STORES_JSON: ${STORES_JSON:-_data/mongo/stores.json}
      REVIEWS_JSON: ${REVIEWS_JSON:-_data/mongo/reviews.json}
    volumes:
      - ./_data/mongo:/app/_data/mongo
    command: ["python", "import_to_mongo.py"]
    restart: "no"
